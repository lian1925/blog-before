<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="/css/base.css?v=1.2">
  <link rel="icon" type="image/png" href="/img/robot.png">
  <link rel="stylesheet" href="/css/post.css?v=1.2">
  <link rel="stylesheet" href="//at.alicdn.com/t/font_407924_kx6yx3r9q4m6xbt9.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css" />

  <title>
    配置pxtarget.json | PXT |
      小梁哥的个人网站
  </title>
<link rel="stylesheet" href="/css/prism-ghcolors.css" type="text/css"></head>

<body>
  <div class="container">
    <div class="header">

      <a class="home-title" style="cursor:default;" onclick="javascript:void(0);return false;"><span>小梁哥的个人网站
        <i class="iconfont icon-shuangjiantou-copy"></i>
      </span></a>

      <a href="/home/">首页</a>
      <span><i class="iconfont icon-shuangjiantou-copy"></i></span>
      <a href="/tags/PXT/">
        PXT
      </a>
      <div class="search">
        <input type="text" placeholder="搜索">
        <i class="iconfont icon-sousuo"></i>
      </div>
    </div>
    <div class="post">
      <h1>配置pxtarget.json | PXT</h1>
      <div class="post-meta">
        <p>作者： Lian</p>
        <p>日期：
          2017年10月11日 19:10
        </p>
      </div>
      <div class="share-button"></div>
    </div>
    <div class="page">
      <h1 id="pxtarget-json-Manual-Page"><a href="#pxtarget-json-Manual-Page" class="headerlink" title="pxtarget.json Manual Page"></a>pxtarget.json Manual Page</h1><p>A PXT target is described by a <code>pxtarget.json</code> JSON file.<br>Here are two examples of <code>pxtarget.json</code> files, one simple and one more complex:</p>
<ul>
<li><a href="https://github.com/Microsoft/pxt-sample/blob/master/pxtarget.json" target="_blank" rel="external">https://github.com/Microsoft/pxt-sample/blob/master/pxtarget.json</a></li>
<li><a href="https://github.com/Microsoft/pxt-microbit/blob/master/pxtarget.json" target="_blank" rel="external">https://github.com/Microsoft/pxt-microbit/blob/master/pxtarget.json</a></li>
</ul>
<p>The JSON file <code>pxtarget.json</code> is described at the top-level by the interfaces <code>TargetBundle</code><br>and <code>AppTarget</code>, shown below.<br>Fields labelled as “DERIVED” in the comments are populated by PXT from other sources,<br>as indicated. All other fields below are user-supplied. Optional fields have a “?” after their name.</p>
<p>All PXT targets also must supply an NPM <a href="https://docs.npmjs.com/files/package.json" target="_blank" rel="external">package.json</a><br>file, which describes the versioning, dependency and resources required to build the target.<br>You can find examples for pxt-sample and pxt-microbit here:</p>
<ul>
<li><a href="https://github.com/Microsoft/pxt-sample/blob/master/package.json" target="_blank" rel="external">https://github.com/Microsoft/pxt-sample/blob/master/package.json</a></li>
<li><a href="https://github.com/Microsoft/pxt-microbit/blob/master/package.json" target="_blank" rel="external">https://github.com/Microsoft/pxt-microbit/blob/master/package.json</a></li>
</ul>
<p>Here’s more about <a href="/target-creation">creating a target</a></p>
<h2 id="TargetBundle"><a href="#TargetBundle" class="headerlink" title="TargetBundle"></a>TargetBundle</h2><p>The interface <code>TargetBundle</code> describes the PXT packages that come bundled<br>with the target (as opposed to being pulled from the web), as well as the semantic<br>version of the target:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface TargetBundle extends AppTarget {
        versions: TargetVersions;       // DERIVED: defines the semantic versioning for the target
        bundleddirs: string[];          // packages to be bundled into web app (libs/*)
    }
</code></pre>
<h3 id="versions-TargetVersions"><a href="#versions-TargetVersions" class="headerlink" title="versions: TargetVersions"></a>versions: TargetVersions</h3><p>PXT uses <a href="http://semver.org/" target="_blank" rel="external">semantic versioning</a> of its targets and packages.  The TargetVersions<br>interface has two relevant fields that are populated as specified below:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface TargetVersions {
        target: string; // equal to version field in "package.json"
        pxt: string;    // equal to version field in "package.json" or "node_modules/pxt-core/package.json"
    }
</code></pre>
<h3 id="bundleddirs-string"><a href="#bundleddirs-string" class="headerlink" title="bundleddirs: string[]"></a>bundleddirs: string[]</h3><p>A target can use many packages in addition to the required “corepkg”. To<br>ensure that a package is bundled into the web app, you must include it in this list. For<br>example in <a href="http://github.com/microsoft/pxt-microbit/blob/master" target="_blank" rel="external">http://github.com/microsoft/pxt-microbit/blob/master</a>, we see:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    "bundleddirs": [
        "libs/core",
        "libs/radio",
        "libs/devices",
        "libs/bluetooth"
    ],
</code></pre>
<p>This ensures that the above four packages are compiled/bundled into the web app and delivered on the initial<br>download of the web app. Other packages for the micro:bit, such as <a href="http://github.com/microsoft/pxt-neopixel" target="_blank" rel="external">http://github.com/microsoft/pxt-neopixel</a><br>are not bundled and remain on github.com, where they are loaded as needed by the web app (usually<br>via an “add package” request by the end user).</p>
<h2 id="AppTarget"><a href="#AppTarget" class="headerlink" title="AppTarget"></a>AppTarget</h2><p>Most of the user-defined fields for <code>pxttarget.json</code> are described by the interface <code>AppTarget</code>.</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface AppTarget {
        id: string;             // unique id: should match ^[a-z]+$; used in URLs and domain names
        name: string;           // friendly name (spaces allowed)
        corepkg: string;        // specifies the directory (under libs/) for target's core APIs
                                // such libraries also are known as packages. See section below.
        compile: CompileTarget; // see sections below for description
        appTheme: AppTheme;     // see sections below for description

        nickname?: string;      // Friendly id (should match ^[a-zA-Z]+$); used when generating files,
                                // folders, etc. defaults to id
        platformid?: string;    // Used as search term in GitHub search for packages; defaults to id

        title?: string;         // for HTML TITLE tag
        description?: string;   // for HTML META Description

        cloud?: AppCloud;       // see sections below for descriptions of the rest of the fields
        simulator?: AppSimulator;
        runtime?: RuntimeOptions;
        compileService?: TargetCompileService;
    }
</code></pre>
<h3 id="corepkg-string"><a href="#corepkg-string" class="headerlink" title="corepkg: string"></a>corepkg: string</h3><p>A target must have a core <a href="/packages">package</a> under the libs/ directory<br>where the core APIs for the target reside.<br>The core package should always be bundled with the web app, as shown below:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    "corepkg": "core",
    "bundleddirs": [
        "libs/core"
    ]
</code></pre>
<h3 id="compile-CompileTarget"><a href="#compile-CompileTarget" class="headerlink" title="compile: CompileTarget"></a>compile: CompileTarget</h3><p>PXT supports compilation to both JavaScript and ARM machine code (native). Web-only targets<br>will not need the native compilation path.</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface CompileTarget {
        isNative: boolean;      // false -> JavaScript compilation only, for simulator
        hasHex: boolean;        // output binary file (implies isNative)
        nativeType?: string;    // currently only "thumb", though there is a prototype for AVR

        // output file options
        useUF2?: boolean;       // true -> output UF2 format (see https://github.com/Microsoft/uf2), false -> HEX file
        hexMimeType?: string;   // Mime type for hex files
        driveName?: string;     // how will the device appear when plugged in via MSD?
        deployDrives?: string;  // partial name of drives where the HEX/UF2 file should be copied

        // code generation options
        floatingPoint?: boolean; // use floating point in JavaScript (default is 32-bit integers)
        taggedInts?: boolean;    // true -> use tagged integers in native (implies floatingPoint)
        shortPointers?: boolean; // true -> 16 bit pointers
        flashCodeAlign?: number; // defaults to 1k page size
        flashChecksumAddr?: number;  // where to store checksum of code

        // advanced debugging options
        boxDebug?: boolean;     // generate debugging code for boxing
        jsRefCounting?: boolean;// generate debugging in JS for reference counting scheme
        openocdScript?: string;
    }
</code></pre>
<h3 id="appTheme-AppTheme"><a href="#appTheme-AppTheme" class="headerlink" title="appTheme: AppTheme"></a>appTheme: AppTheme</h3><p>PXT has a large number of options for controlling<br>the <a href="/targets/theming">look and feel</a> of a target.<br>Here is the appTheme from pxt-sample with some comments:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    "appTheme": {
        // URLs to use for various components of the UI
        "logoUrl": "https://microsoft.github.io/pxt-sample/",
        "homeUrl": "https://microsoft.github.io/pxt-sample/",
        "privacyUrl": "https://go.microsoft.com/fwlink/?LinkId=521839",
        "termsOfUseUrl": "https://go.microsoft.com/fwlink/?LinkID=206977",
        "betaUrl": "https://makecode.com/",
        // populating the (?) menu
        "docMenu": [
            {
                "name": "About",
                "path": "/about"
            },
            {
                "name": "Docs",
                "path": "/docs"
            }
        ],
        // enable toolbox for both Blockly and JavaScript
        "coloredToolbox": true,
        "monacoToolbox": true,
        "invertedMenu": true,
        "simAnimationEnter": "rotate in",
        "simAnimationExit": "rotate out"
    }
</code></pre>
<h3 id="cloud-AppCloud"><a href="#cloud-AppCloud" class="headerlink" title="cloud?: AppCloud"></a>cloud?: AppCloud</h3><p>PXT has a cloud backend that provides a set of services to the web app.  The services are configured using<br>the <code>cloud</code> field in pxttarget.json, defined by the <code>AppCloud</code> interface:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface AppCloud {
        sharing?: boolean;      // enable anonymous sharing of projects via URL
        importing?: boolean;    // enable import of a previously shared project from
                                // a URL (requires sharing? and publishing?)

        packages?: boolean;           // enabled loading of packages (from github)
        preferredPackages?: string[]; // list of company/project(#tag) of packages on github
        githubPackages?: boolean;     // enable user-specified term for searching github for packages

        // to be retired soon
        publishing?: boolean;   // must set true for importing? to work; no other purpose evident
        embedding?: boolean;

        // not currently supported
        workspaces?: boolean;
    }
</code></pre>
<p>For example in the pxttarget.json for <a href="http://github.com/microsoft/pxt-microbit" target="_blank" rel="external">http://github.com/microsoft/pxt-microbit</a>, we see:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    "cloud": {
        "workspace": false,
        "packages": true,
        "sharing": true,
        "publishing": true,
        "preferredPackages": [
            "Microsoft/pxt-neopixel"
        ],
        "githubPackages": true
    }
</code></pre>
<h3 id="simulator-AppSimulator"><a href="#simulator-AppSimulator" class="headerlink" title="simulator?: AppSimulator;"></a>simulator?: AppSimulator;</h3><p>PXT provides a JavaScript-based simulation environment on the left side of the web<br>app (typically for physical computing devices like the micro:bit).  PXT uses the<br>term <a href="/targets/board">board</a> to refer to the main physical computing device shown in the simulator.<br>Each target has one board (plus optional parts).</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface AppSimulator {
        // define aspects of physical computing device
        boardDefinition?: BoardDefinition;

        // running and code changes
        autoRun?: boolean;          // automatically run program after a change to its code
        stopOnChange?: boolean;     // stop execution when user changes code
        headless?: boolean;         // whether simulator should still run while collapsed

        // buttons and parts
        hideRestart?: boolean;      // hide the restart button
        hideFullscreen?: boolean;   // hide the fullscreen button
        enableTrace?: boolean;      // enable the slow-mode (snail) button
        parts?: boolean;            // parts enabled?
        instructions?: boolean;     // generate step-by-step wiring instructions (Make button)

        // appearance
        aspectRatio?: number;       // width / height
        partsAspectRatio?: number;  // aspect ratio of the simulator when parts are displayed

        // miscellaneous
        trustedUrls?: string[];     // URLs that are allowed in simulator modal messages
    }
</code></pre>
<h3 id="runtime-RuntimeOptions"><a href="#runtime-RuntimeOptions" class="headerlink" title="runtime?: RuntimeOptions;"></a>runtime?: RuntimeOptions;</h3><p>This severely misnamed option controls the available blocks in the Blockly editor:</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface RuntimeOptions {
        // control whether or not Blockly built-in categories appear
        mathBlocks?: boolean;       
        textBlocks?: boolean;
        listsBlocks?: boolean;
        variablesBlocks?: boolean;
        logicBlocks?: boolean;
        loopsBlocks?: boolean;

        // options specific to the special "on start" block
        onStartNamespace?: string; // default = loops
        onStartColor?: string;
        onStartWeight?: number;
        onStartUnDeletable?: boolean;
    }
</code></pre>
<h3 id="compileService-TargetCompileService"><a href="#compileService-TargetCompileService" class="headerlink" title="compileService?: TargetCompileService;"></a>compileService?: TargetCompileService;</h3><p>PXT provides a compile service for C/C++ code that may be included in a target/package.<br>Currently, this compile service can be configured<br>to use either <a href="https://www.mbed.com/en/platform/software/mbed-yotta/" target="_blank" rel="external">yotta</a><br>or <a href="http://platformio.org/" target="_blank" rel="external">platformio</a>.<br>PXT defaults to using local installs of yotta and platformio.<br>PXT expects to find the C/C++ sources on github.</p>
<pre class=" language-typescript-ignore"><code class="language-typescript-ignore">    interface TargetCompileService {
        buildEngine?: string;           // default is yotta, set to platformio
        // where are the sources
        githubCorePackage?: string;     // e.g. lancaster-university/microbit
        gittag: string;
        // yotta configuration
        yottaCorePackage?: string;      // name for PXT use
        yottaTarget?: string;           // name of yotta target to build
        yottaBinary?: string;           // name of yotta output file
        yottaConfig?: any;              // additional config
        // platformio configuration
        platformioIni?: string[];       // define contents of platformio.ini file

        serviceId: string;
    }
</code></pre>

    </div>
    <h2 class="post-nav">
      
      <a href="/2017/10/11/pxt-target/" class="prev">上一篇：编译 | PXT</a>
      
      <a href="/2017/10/11/pxt-define-blocks/" class="next">下一篇：定义blocks | PXT</a>

    </h2>

    <div class="footer">
      Copyright @ <a href="/">lian</a> | 2009-2017
    </div>
  </div>

  <script src="/js/jquery.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
  <script src="/js/post.js"></script>


</body>

</html>

